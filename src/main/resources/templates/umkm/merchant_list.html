<!doctype html>
<html lang="id" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{base_layout}">
<head>
    <title class="fw-semibold" th:text="#{merchant.title}"></title>
</head>
<body>
<section layout:fragment="content">
    <div class="container pt-1">
        <!-- Header -->
        <div class="d-flex justify-content-between align-items-center mb-1">

            <h5 class="fw-semibold mb-0" th:text="#{merchant.title}"></h5>

            <div class="input-group input-group-sm" style="width: 260px;">
                <input type="text"
                       class="form-control border-start-0"
                       th:placeholder="#{search.placeholder}">
                <span class="input-group-text bg-white border-end-0">
                    <i class="fa fa-search text-muted"></i>
                </span>
            </div>

        </div>

        <!-- Alert -->
        <div th:if="${success}"
             class="alert alert-success alert-dismissible fade show shadow-sm"
             role="alert">
            <span th:text="${success}"></span>
            <button type="button"
                    class="btn-close"
                    data-bs-dismiss="alert"></button>
        </div>
        <!-- Card -->
        <div class="card shadow-sm border-0">
            <div class="card-body rounded-3 pt-2 pb-3">

                <table class="table table-hover align-middle mb-0">
                    <thead class="table-light">
                    <tr>
                        <th class="fw-semibold text-secondary" th:text="#{merchant.owner}"></th>
                        <th class="fw-semibold text-secondary" th:text="#{merchant.name}"></th>
                        <th class="text-end fw-semibold text-secondary" th:text="#{action}"></th>
                    </tr>
                    </thead>

                    <tbody>
                    <tr th:each="m : ${merchants}">
                        <td th:text="${m.ownerName}"></td>
                        <td th:text="${m.name}"></td>
                        <td class="text-end">
                            <a th:href="@{/merchants/{id}(id=${m.id})}"
                               class="btn btn-sm btn-outline-secondary me-1" th:text="#{view}">
                            </a>
                            <a th:if="${role == 'ADMIN'}" th:href="@{/merchants/{id}/edit(id=${m.id})}"
                               class="btn btn-sm btn-outline-primary me-1" th:text="#{edit}">
                            </a>
                        </td>
                    </tr>
                    </tbody>
                </table>

                <div class="d-flex justify-content-between align-items-center mt-3 flex-wrap">
                    <!-- LEFT SIDE -->
                    <div class="d-flex align-items-center gap-4">
                        <!-- Pagination -->
                        <nav th:if="${totalPages > 1}">
                            <ul class="pagination custom-pagination mb-0">

                                <!-- Previous -->
                                <li class="page-item"
                                    th:classappend="${currentPage == 0} ? 'disabled'">
                                    <a class="page-link"
                                       th:href="@{/merchants(page=${currentPage - 1}, size=${pageSize})}">
                                        &laquo;
                                    </a>
                                </li>

                                <!-- First -->
                                <li class="page-item"
                                    th:if="${currentPage > 2}">
                                    <a class="page-link"
                                       th:href="@{/merchants(page=0, size=${pageSize})}">
                                        1
                                    </a>
                                </li>

                                <li class="page-item disabled"
                                    th:if="${currentPage > 3}">
                                    <span class="page-link">...</span>
                                </li>

                                <!-- Middle -->
                                <li class="page-item"
                                    th:each="i : ${#numbers.sequence(
                        T(java.lang.Math).max(0, currentPage - 2),
                        T(java.lang.Math).min(totalPages - 1, currentPage + 2)
                    )}"
                                    th:classappend="${i == currentPage} ? 'active'">

                                    <a th:if="${i != currentPage}"
                                       class="page-link"
                                       th:text="${i + 1}"
                                       th:href="@{/merchants(page=${i}, size=${pageSize})}">
                                    </a>

                                    <span th:if="${i == currentPage}"
                                          class="page-link"
                                          th:text="${i + 1}">
                    </span>
                                </li>

                                <li class="page-item disabled"
                                    th:if="${currentPage < totalPages - 4}">
                                    <span class="page-link">...</span>
                                </li>

                                <!-- Last -->
                                <li class="page-item"
                                    th:if="${currentPage < totalPages - 3}">
                                    <a class="page-link"
                                       th:href="@{/merchants(page=${totalPages - 1}, size=${pageSize})}"
                                       th:text="${totalPages}">
                                    </a>
                                </li>

                                <!-- Next -->
                                <li class="page-item"
                                    th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
                                    <a class="page-link"
                                       th:href="@{/merchants(page=${currentPage + 1}, size=${pageSize})}">
                                        &raquo;
                                    </a>
                                </li>

                            </ul>
                        </nav>
                        <!-- Page Size -->
                        <form method="get" th:action="@{/merchants}" class="mb-0">
                            <input type="hidden" name="page" value="0"/>

                            <select class="form-select form-select-sm"
                                    style="width: 110px;"
                                    name="size"
                                    onchange="this.form.submit()">

                                <option value="5"  th:selected="${pageSize == 5}">5 / page</option>
                                <option value="10" th:selected="${pageSize == 10}">10 / page</option>
                                <option value="25" th:selected="${pageSize == 25}">25 / page</option>
                                <option value="50" th:selected="${pageSize == 50}">50 / page</option>

                            </select>
                        </form>

                        <!-- Total -->
                        <div class="total-text mb-0">
                            Total <span th:text="${totalElements}"> Data</span>
                        </div>
                    </div>

                    <!-- Add Button -->
                    <div th:if="${role == 'ADMIN'}">
                        <a th:href="@{/merchants/add}"
                           class="btn btn-brand btn-sm">
                            <i class="fa fa-plus me-1"></i>
                            <span th:text="#{merchant.add}"></span>
                        </a>
                    </div>
                </div>

            </div>
        </div>
    </div>
</section>
</body>
</html>
